---
layout: post
title: Simple Loading Screen to wait for SPSerivces
---

SPServices is an excellent library for extending SharePoint functionality without touching anything server side.  It is especially great for making SharePoint's NewForm.aspx more dynamic.  I can do basic hide and show with jQuery and use SPSerivces for more complex tasks like generating a cascading dropdown.  

However I ran into an issue after making a few too many calls to SPServices on page load.  I ran into at least 3 seconds lag while SPServices was running.  Anything more than a few hundred millaseconds is unacceptable without a load screen.  So I created a simple loading screen using jQuery and CSS.  Instead, I HIDE all fields, DISPLAY a static message that says LOADING, then SHOW all needed fields again.

How to hide all of the fields in my NewForm.aspx?  I want to keep the ribbon and quick links on the page, so I found a div generated by SharePoint that holds the bulk of NewForm.aspx.
<div class="s4-ca s4-ca-dlgNoRibbon" id="MSO_ContentTable">
This is the root div for the form in browser.  It also is the root for the form when it loads in the modal window.  Perfect.  So simply grab that id, add a loading message before, apply CSS to it, and hide MSO_ContentTable. 

function successInitializeSPServices() {
	// SPServices code here

	// Loading Page - Show page again after SPServices has run.
    $("#MSO_ContentTable").show();
    $("#Loading").remove();
}

function hideForLoading() {
    $("#MSO_ContentTable").before("<div id='Loading'>Loading please wait...</div>");
    $("#Loading").css({
        "height": "100%",
        "width": "100%",
        "position": "fixed",
        "left": "50%",
        "top": "50%",
        "margin": "-25px 0 0 -25px",
        "z-index": "1000"
    });
    $("#MSO_ContentTable").hide();
}

$(document).ready(function () {

    hideForLoading();

    // LOAD SPSERVICES
    $.getScript("/SiteAssets/jquery.SPServices.js", successInitializeSPServices);
});


Then as shown above in the successInitializeSPServices function, after your SPServices calls have run, show the #MSO_Content div and hide the temporary #Loading div you created to show your load message.